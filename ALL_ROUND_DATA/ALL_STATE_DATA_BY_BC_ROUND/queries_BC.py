# NEED TO CHANGE CTE - SELECT QUERIES ...
bc_ap = """  
WITH CTE AS
(
SELECT  -- AP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'YSRCP'
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'YSRCP'
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BYIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'TDP'
WHEN SEQ = 'BYIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'YSRCP'
WHEN SEQ = 'BYIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BYIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'BYIO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'YBIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'YSRCP'
WHEN SEQ = 'YBIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'TDP'
WHEN SEQ = 'YBIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'YBIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'YBIO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BYIO'
WHEN VENDOR_ID IN (4) THEN 'YBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Andhr%'
  AND Campaign_Name LIKE 'AP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,8,9,20,23,24)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AP')

UNION ALL

SELECT  -- AP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'YSRCP'
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BYIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'YSRCP'
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'YBIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BYIO'
WHEN VENDOR_ID IN (4) THEN 'YBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Andhr%'
  AND Campaign_Name LIKE 'AP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,8,9,20,23,24)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AP')

UNION ALL

SELECT  -- AP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'TDP'
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'YSRCP'
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'YSRCP'
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'TDP'
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'TYIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'TDP'
WHEN SEQ = 'TYIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'YSRCP'
WHEN SEQ = 'TYIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'TYIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'TYIO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'YTIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'YSRCP'
WHEN SEQ = 'YTIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'TDP'
WHEN SEQ = 'YTIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'YTIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'YTIO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'TYIO'
WHEN VENDOR_ID IN (4) THEN 'YTIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Andhr%'
  AND Campaign_Name LIKE 'AP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (2,3,4,5,6,7,10,11,12,13,14,15,16,17,18,19,21,22,25)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AP')

UNION ALL

SELECT  -- AP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'TDP'
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'YSRCP'
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'TYIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'YSRCP'
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'TDP'
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'YTIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'TYIO'
WHEN VENDOR_ID IN (4) THEN 'YTIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Andhr%'
  AND Campaign_Name LIKE 'AP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (2,3,4,5,6,7,10,11,12,13,14,15,16,17,18,19,21,22,25)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AP')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_asm = """
WITH CTE AS
(
SELECT              -- AS QUERY 
A.STATE_CODE+'-'+CAST(B.PC_No AS varchar) AS PC_ID,
A.STATE_CODE,
VENDOR_ID,
MOBILE,
CALL_STATUS,
STIME,
DURATION,
RESPONSE,
VENDOR,
PARTY,
B.AC_NO,
B.PC_No,
BOOTH,
VOTERIDNUMBER,
GENDER,
AGE,
POOLINGBOOTH,
SEQ,
RES1,
RES2,
state,
CASTE
FROM
(
SELECT  -- AS
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BITO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BITO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BITO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'ATC'
WHEN SEQ = 'BITO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'ATC'
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BITO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BITO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BITO' AND (  RESPONSE LIKE '%,7%' ) THEN 'ATC'
WHEN SEQ = 'BITO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,7%' ) THEN 'ATC'
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BITO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBTO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'ASSA%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND PC_NO IN (10)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL

SELECT  -- AS
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'AIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'AIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'AIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IAO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IAO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'IAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'AIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'AIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'AIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IAO'
WHEN VENDOR_ID IN (4) THEN 'AIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'ASSA%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND PC_NO IN (11)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL

SELECT  -- AS_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Assam%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (2,3,7,8,9,12,13,14)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL

SELECT  -- AS_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Assam%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (2,3,7,8,9,12,13,14)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL 

SELECT  -- AS_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AGP'
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIUDF'
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IGAO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IGAO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AGP'
WHEN SEQ = 'IGAO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AIUDF'
WHEN SEQ = 'IGAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IGAO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Assam%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (4,6)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL

SELECT  -- AS_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AGP'
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIUDF'
WHEN SEQ = 'IGAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IGAO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Assam%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (4,6)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL

SELECT  -- AS_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIUDF'
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBAO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBAO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBAO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AIUDF'
WHEN SEQ = 'IBAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBAO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Assam%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL

SELECT  -- AS_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIUDF'
WHEN SEQ = 'IBAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBAO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Assam%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')

UNION ALL

SELECT  -- AS
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Assam%'
  AND Campaign_Name LIKE 'AS-BC-PC%'
  AND PC_NO IN (5)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('AS')
) AS A INNER JOIN INDIA_DATA_TURNOUT B ON A.AC_NO = B.AC_NO WHERE B.State_Code = 'AS'
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_br = """
WITH CTE AS
(
SELECT   ---BR
PC_ID,
STATE_CODE,
VENDOR_ID,
MOBILE,
CALL_STATUS,
STIME,
DURATION,
RESPONSE,
VENDOR,
PARTY,
AC_NO,
PC_NO,
BOOTH,
VOTERIDNUMBER,
GENDER,
AGE,
POOLINGBOOTH,
SEQ,
CASE 
WHEN PC_ID IN ('BR-16','BR-21','BR-23','BR-40') AND RES1 IN ('BJP') THEN 'LJP'
WHEN PC_ID IN ('BR-4','BR-5','BR-7','BR-9','BR-13','BR-14','BR-16','BR-17','BR-18','BR-19','BR-20','BR-21','BR-24','BR-26','BR-27','BR-31','BR-33','BR-36','BR-39') AND RES1 IN ('INC') THEN 'RJD'
ELSE RES1 END AS RES1,
RES2,
state,
CASTE
FROM
(
SELECT	-- BR
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'LRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'LJP'
WHEN SEQ = 'LRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RJD'
WHEN SEQ = 'LRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'RLO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RJD'
WHEN SEQ = 'RLO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'LJP'
WHEN SEQ = 'RLO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'LRO' AND (  RESPONSE LIKE '%,5%' ) THEN 'LJP'
WHEN SEQ = 'LRO' AND (  RESPONSE LIKE '%,6%' ) THEN 'RJD'
WHEN SEQ = 'LRO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'RLO' AND (  RESPONSE LIKE '%,5%' ) THEN 'RJD'
WHEN SEQ = 'RLO' AND (  RESPONSE LIKE '%,6%' ) THEN 'LJP'
WHEN SEQ = 'RLO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'LRO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'RLO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Bihar%'
  AND PC_NO = 39
  AND Start_Time < '2024-03-15'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('BR')

UNION ALL

SELECT  --- BR
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Bihar%'
  AND Campaign_Name LIKE 'BR-BC-PC%'
  --AND Q2_Type = 'LSE_2019'
  AND PC_NO <> 39
  AND Start_Time < '2024-03-15'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('BR')
) AS T1
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_cg = """
WITH CTE AS
(
SELECT  -- CG
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'CHHATT%'
  AND Campaign_Name LIKE 'CG-BC-PC%'
  AND PC_NO IN (3,4,10,11)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('CG')
UNION ALL
SELECT  -- CG_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Chhattisgarh%'
  AND Campaign_Name LIKE 'CG-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,2,5,6,7,8,9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('CG')
UNION ALL
SELECT  -- CG_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Chhattisgarh%'
  AND Campaign_Name LIKE 'CG-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,2,5,6,7,8,9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('CG')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_ch = """
WITH CTE AS
(
SELECT  --- CH_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Chandigarh%'
  AND Campaign_Name LIKE 'CH-BC-PC%-LSE%'
  AND PC_NO IN (1)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('CH')

UNION ALL

SELECT  -- CH_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Chandigarh%'
  AND Campaign_Name LIKE 'CH-BC-PC%-PM%'
  AND PC_NO IN (1)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('CH')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_dl = """
WITH CTE AS
(
SELECT  -- DL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (4) THEN 'ABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Delhi%'
  AND Campaign_Name LIKE 'DL-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (4,6,7)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('DL')

UNION ALL

SELECT  -- DL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (4) THEN 'ABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Delhi%'
  AND Campaign_Name LIKE 'DL-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (4,6,7)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('DL')

UNION ALL

SELECT  -- DL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
WHEN VENDOR_ID IN (4) THEN 'ABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Delhi%'
  AND Campaign_Name LIKE 'DL-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,2,3,5)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('DL')

UNION ALL

SELECT  -- DL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
WHEN VENDOR_ID IN (4) THEN 'ABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Delhi%'
  AND Campaign_Name LIKE 'DL-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,2,3,5)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('DL')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_ga = """
WITH CTE AS
(
SELECT  --- GA_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Goa%'
  AND Campaign_Name LIKE 'GA-BC%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('GA')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_gj = """
WITH CTE AS
(
SELECT  -- GJ_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Gujarat%'
  AND Campaign_Name LIKE 'GJ-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO <> 15
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('GJ')

UNION ALL

SELECT  -- GJ_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Gujarat%'
  AND Campaign_Name LIKE 'GJ-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO <> 15
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('GJ')

UNION ALL

SELECT  -- GJ_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AAP'
WHEN SEQ = 'BAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AAP'
WHEN SEQ = 'BAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Gujarat%'
  AND Campaign_Name LIKE 'GJ-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO = 15
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('GJ')

UNION ALL

SELECT  -- GJ_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AAP'
WHEN SEQ = 'BAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Gujarat%'
  AND Campaign_Name LIKE 'GJ-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO = 15
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('GJ')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_hp = """
WITH CTE AS
(
SELECT  ---HP
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
WHEN VENDOR_ID IN (4) THEN 'OBI'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Himachal%'
  AND Start_Time < '2024-03-25'
  AND PC_NO = 3
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('HP')
UNION ALL
SELECT  -- HP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Himachal_Pradesh%'
  AND Campaign_Name LIKE 'HP-BC-PC%-LSE'
  AND PC_NO IN (1,2,4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('HP')

UNION ALL

SELECT  -- HP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Himachal_Pradesh%'
  AND Campaign_Name LIKE 'HP-BC-PC%-PM'
  AND PC_NO IN (1,2,4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('HP')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_tn = """
WITH CTE AS
(
SELECT  --- TN
PC_ID,
STATE_CODE,
VENDOR_ID,
MOBILE,
CALL_STATUS,
STIME,
DURATION,
RESPONSE,
VENDOR,
PARTY,
AC_NO,
PC_NO,
BOOTH,
VOTERIDNUMBER,
GENDER,
AGE,
POOLINGBOOTH,
SEQ,
--RES1 AS RES1_,
CASE 
WHEN PC_ID IN ('TN-1','TN-9','TN-12','TN-23','TN-24','TN-31','TN-33','TN-34','TN-39') AND RES1 IN ('DMK','INC') THEN 'INC'
WHEN PC_ID IN ('TN-18','TN-29') AND RES1 IN ('DMK','INC') THEN 'CPI' 
WHEN PC_ID IN ('TN-20','TN-32') AND RES1 IN ('DMK','CPIM') THEN 'CPIM'
WHEN PC_ID IN ('TN-35') AND RES1 IN ('DMK','IUML') THEN 'IUML' 
WHEN PC_ID IN ('TN-27') AND RES1 IN ('DMK','VCK') THEN 'VCK' 
ELSE RES1 END AS RES1,
RES2,
state,
CASTE
FROM
(
SELECT 
STATE_CODE + '-' + CAST( PC_NO AS varchar) AS PC_ID,
*
FROM
(
SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDNAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDNAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN SEQ = 'BDNAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'NTK'
WHEN SEQ = 'BDNAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIADMK'
WHEN SEQ = 'BDNAO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDNAO' AND (  RESPONSE LIKE '%,6%' ) THEN 'DMK'
WHEN SEQ = 'BDNAO' AND (  RESPONSE LIKE '%,7%' ) THEN 'NTK'
WHEN SEQ = 'BDNAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'AIADMK'
--
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
--
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,7%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BDNAO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Tamil%'
  AND Start_Time < '2024-03-20'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (3,21,38)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BACNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BACNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AIADMK'
WHEN SEQ = 'BACNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN SEQ = 'BACNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BACNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABCNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABCNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABCNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN SEQ = 'ABCNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABCNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'NCABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NTK'
WHEN SEQ = 'NCABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'NCABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'NCABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'NCABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'CBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'CBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'CBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'CBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'CBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BACNO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BACNO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPIM'
WHEN SEQ = 'BACNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'BACNO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABCNO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABCNO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPIM'
WHEN SEQ = 'ABCNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'ABCNO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'NCABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'NTK'
WHEN SEQ = 'NCABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPIM'
WHEN SEQ = 'NCABO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'NCABO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'CBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPIM'
WHEN SEQ = 'CBANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'CBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'CBANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BACNO'
WHEN VENDOR_ID IN ('5') THEN 'ABCNO'
WHEN VENDOR_ID IN ('4') THEN 'NCABO'
WHEN VENDOR_ID IN ('12') THEN 'CBANO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time <= '2024-02-19'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (20)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BDANO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [ACNO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time >= '2024-02-19'
  AND Start_Time < '2024-03-20'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (20)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,7%' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BDANO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [ACNO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time >= '2024-02-22'
  AND Start_Time < '2024-03-20'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (16,17,19,18,32)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,7%' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BDANO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [ACNO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time >= '2024-02-22'
  AND Start_Time < '2024-03-20'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (35,39)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BDANO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [ACNO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time >= '2024-02-22'
  AND Start_Time < '2024-03-20'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (37)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'DMDK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'DMDK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,5%' ) THEN 'DMDK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,7%' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BDANO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [ACNO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time >= '2024-02-22'
  AND Start_Time < '2024-03-20'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (24)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'BDANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BDANO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [ACNO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time >= '2024-02-22'
  AND Start_Time < '2024-03-20'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (31)

UNION ALL

SELECT
*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AIADMK'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
'TN' AS STATE_CODE,
*,
CASE
WHEN VENDOR_ID IN ('9','7') THEN 'BADNO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
ELSE 'SET' END AS SEQ
FROM
(
SELECT MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [ACNO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Start_Time >= '2024-02-22'
  AND Start_Time < '2024-03-20'
  AND state LIKE 'Tamil%'
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND PC_NO IN (1,2,4,5,6,7,8,9,10,11,12,13,14,15,22,23,25,26,27,28,29,30,33,34,36)
) AS T1
) AS T2
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_hr = """
SELECT
MOBILE AS DN,
CAST(STIME AS date) AS Start_Time,
RESPONSE AS DTMF_REP,
'HARYANA' AS state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
'' AS CASTE
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY MOBILE ORDER BY STIME DESC) AS VALID_NUM
FROM
(
SELECT  --- HR_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Haryana%'
  AND Campaign_Name LIKE 'HR-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (6,7,1,5,8,9,10)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('HR')

UNION ALL

SELECT  -- HR_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Haryana%'
  AND Campaign_Name LIKE 'HR-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (6,7,1,5,8,9,10)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('HR')

UNION ALL

SELECT  -- HR_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'JJP'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'JJP'
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBJO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBJO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBJO' AND (  RESPONSE LIKE '%,7%' ) THEN 'JJP'
WHEN SEQ = 'IBJO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABJO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AAP'
WHEN SEQ = 'ABJO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABJO' AND (  RESPONSE LIKE '%,7%' ) THEN 'JJP'
WHEN SEQ = 'ABJO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBJO'
WHEN VENDOR_ID IN (4) THEN 'ABJO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Haryana%'
  AND Campaign_Name LIKE 'HR-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (2,3,4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('HR')

UNION ALL

SELECT  -- HR_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'JJP'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'JJP'
WHEN SEQ = 'ABJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBJO'
WHEN VENDOR_ID IN (4) THEN 'ABJO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Haryana%'
  AND Campaign_Name LIKE 'HR-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (2,3,4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('HR')

UNION ALL

SELECT				-- HR LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Haryana%'
  AND Campaign_Name LIKE 'HR-PP-%'
  AND Start_Time >= '2024-03-25'
  AND Start_Time < '2024-04-30'
  --AND PC_NO IN (7,6)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL

UNION ALL 

SELECT				-- HR LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'JJP'
WHEN PARTY = 'BIJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'JJP'
WHEN PARTY = 'IBJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN PARTY = 'BIJO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN PARTY = 'BIJO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN PARTY = 'BIJO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBJO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN PARTY = 'IBJO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN PARTY = 'IBJO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Haryana%'
  AND Campaign_Name LIKE 'HR-PP-%'
  AND Start_Time >= '2024-03-25'
  AND Start_Time < '2024-04-30'
  --AND PC_NO IN (3)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL

  UNION ALL

  SELECT				-- HR LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AAP'
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Haryana%'
  AND Campaign_Name LIKE 'HR-PP-%'
  AND Start_Time >= '2024-04-05'
  AND Start_Time < '2024-04-30'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
  ) AS T3
  ) AS T4
  WHERE VALID_NUM = 1
"""

bc_jh = """
WITH CTE AS
(
SELECT  --- JH_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
----
WHEN SEQ = 'JBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'JMM'
WHEN SEQ = 'JBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'JBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
-----
WHEN SEQ = 'JBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'JMM'
WHEN SEQ = 'JBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'JBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
WHEN VENDOR_ID IN (4) THEN 'JBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Jharkhand%'
  AND Campaign_Name LIKE 'JH-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,11,4,12,10,8,14,7,2,6,9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('JH')

UNION ALL

SELECT  -- JH_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
----
WHEN SEQ = 'JBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'JMM'
WHEN SEQ = 'JBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'JBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
WHEN VENDOR_ID IN (4) THEN 'JBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Jharkhand%'
  AND Campaign_Name LIKE 'JH-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,11,4,12,10,8,14,7,2,6,9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('JH')

UNION ALL

SELECT  -- JH_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
----
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
-----
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Jharkhand%'
  AND Campaign_Name LIKE 'JH-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (3,5,13)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('JH')

UNION ALL

SELECT  -- JH_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
----
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Jharkhand%'
  AND Campaign_Name LIKE 'JH-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (3,5,13)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('JH')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_ka = """
WITH CTE AS
(
SELECT  -- KA
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BJIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BJIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BJIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BJIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BJIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BJIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBJO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBJO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBJO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BJIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBJO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'KARNA%'
  AND Campaign_Name LIKE 'KA-BC-PC%'
  AND PC_NO = 23
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KA')

UNION ALL

SELECT  -- KA_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Karnataka%'
  AND Campaign_Name LIKE 'KA-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,2,3,5,6,7,8,9,10,11,13,17,18,21,22,24,25,26,27,28)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KA')

UNION ALL

SELECT  -- KA_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Karnataka%'
  AND Campaign_Name LIKE 'KA-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,2,3,5,6,7,8,9,10,11,13,17,18,21,22,24,25,26,27,28,4,12,14,15,16,19,20)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KA')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_kl = """
WITH CTE AS
(
SELECT  --- KL
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BICO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BICO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BICO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPI'
WHEN SEQ = 'BICO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPI'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'CBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPI'
WHEN SEQ = 'CBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'CBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'CBIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BICO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BICO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BICO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPI'
WHEN SEQ = 'BICO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPI'
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'CBIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPI'
WHEN SEQ = 'CBIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'CBIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'CBIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BICO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBCO'
WHEN VENDOR_ID IN (4) THEN 'CBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kera%'
  AND PC_NO = 10
  AND Start_Time < '2024-04-01'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPI'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPI'
WHEN SEQ = 'IBCO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBCO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (20)
  AND Start_Time < '2024-04-01'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPI'
WHEN SEQ = 'IBCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBCO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (20)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IMBO'
WHEN VENDOR_ID IN (4) THEN 'MIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (15,1,17,5,2,19,8,11,12,3)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IMBO'
WHEN VENDOR_ID IN (4) THEN 'MIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (15,1,17,5,2,19,8,11,12,3)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPI'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPI'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'ICBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'ICBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPI'
WHEN SEQ = 'ICBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'ICBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'CIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPI'
WHEN SEQ = 'CIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'CIBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'CIBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ICBO'
WHEN VENDOR_ID IN (4) THEN 'CIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPI'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPI'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ICBO'
WHEN VENDOR_ID IN (4) THEN 'CIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'LDF'
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'IUML'
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'IUML'
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'LDF'
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'LUBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'LDF'
WHEN SEQ = 'LUBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'IUML'
WHEN SEQ = 'LUBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'LUBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ULBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'IUML'
WHEN SEQ = 'ULBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'LDF'
WHEN SEQ = 'ULBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'ULBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'LUBO'
WHEN VENDOR_ID IN (4) THEN 'ULBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (7)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'LDF'
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'IUML'
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'LUBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'IUML'
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'LDF'
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ULBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'LUBO'
WHEN VENDOR_ID IN (4) THEN 'ULBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (7)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'IUML'
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'IUML'
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'UMBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'IUML'
WHEN SEQ = 'UMBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPIM'
WHEN SEQ = 'UMBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'UMBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'MUBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPIM'
WHEN SEQ = 'MUBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'IUML'
WHEN SEQ = 'MUBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'MUBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'UMBO'
WHEN VENDOR_ID IN (4) THEN 'MUBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (6)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'IUML'
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'UMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'IUML'
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MUBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'UMBO'
WHEN VENDOR_ID IN (4) THEN 'MUBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (6)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IMBO'
WHEN VENDOR_ID IN (4) THEN 'MIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IMBO'
WHEN VENDOR_ID IN (4) THEN 'MIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPI'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPI'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'ICBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'ICBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPI'
WHEN SEQ = 'ICBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'CIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPI'
WHEN SEQ = 'CIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'CIBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ICBO'
WHEN VENDOR_ID IN (4) THEN 'CIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (16)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPI'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ICBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPI'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'CIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ICBO'
WHEN VENDOR_ID IN (4) THEN 'CIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (16)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'LDF'
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'LDF'
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'ILBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'ILBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'LDF'
WHEN SEQ = 'ILBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'LIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'LDF'
WHEN SEQ = 'LIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'LIBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ILBO'
WHEN VENDOR_ID IN (4) THEN 'LIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (13)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'LDF'
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ILBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'LDF'
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'LIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ILBO'
WHEN VENDOR_ID IN (4) THEN 'LIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (13)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IMBO'
WHEN VENDOR_ID IN (4) THEN 'MIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (14)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IMBO'
WHEN VENDOR_ID IN (4) THEN 'MIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (14)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RSP'
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIMK'
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIMK'
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RSP'
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'RMBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'RSP'
WHEN SEQ = 'RMBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'CPIMK'
WHEN SEQ = 'RMBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'RMBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'MRBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPIMK'
WHEN SEQ = 'MRBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'RSP'
WHEN SEQ = 'MRBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'MRBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'RMBO'
WHEN VENDOR_ID IN (4) THEN 'MRBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (18)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')

UNION ALL

SELECT  -- KL_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RSP'
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIMK'
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'RMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIMK'
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RSP'
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'MRBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'RMBO'
WHEN VENDOR_ID IN (4) THEN 'MRBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Kerala%'
  AND Campaign_Name LIKE 'KL-BC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (18)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('KL')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_mh = """
WITH CTE AS
(
SELECT  -- MH
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Maharashtra%'
  AND Campaign_Name LIKE 'MH-BC-PC%'
  --AND Q2_Type = 'LSE_2019'
  AND PC_NO IS NOT NULL
  AND Start_Time < '2024-03-15'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('MH')

UNION ALL

SELECT			-- MH LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'BIVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'IBVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ISVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'ISVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(SHS)'
WHEN PARTY = 'ISVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'ISVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SIVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(SHS)'
WHEN PARTY = 'SIVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'SIVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'SIVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SUO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(SHS)'
WHEN PARTY = 'SUO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'SUO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'USO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'USO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(SHS)'
WHEN PARTY = 'USO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(SHS)'
WHEN PARTY = 'SIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'SIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'ISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(SHS)'
WHEN PARTY = 'ISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BPO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BPO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NCPSP'
WHEN PARTY = 'BPO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NCPSP'
WHEN PARTY = 'PBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'PBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BUO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BUO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'BUO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'UBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'UBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'UBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'NPO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NCP'
WHEN PARTY = 'NPO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NCPSP'
WHEN PARTY = 'NPO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NCPSP'
WHEN PARTY = 'PNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NCP'
WHEN PARTY = 'PNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'NUO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NCP'
WHEN PARTY = 'NUO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'NUO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'UNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'UNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NCP'
WHEN PARTY = 'UNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'NPVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NCP'
WHEN PARTY = 'NPVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NCPSP'
WHEN PARTY = 'NPVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'NPVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PNVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NCPSP'
WHEN PARTY = 'PNVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NCP'
WHEN PARTY = 'PNVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'PNVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'RUVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RSPS'
WHEN PARTY = 'RUVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'RUVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'RUVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'URVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'URVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RSPS'
WHEN PARTY = 'URVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'URVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SUVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(SHS)'
WHEN PARTY = 'SUVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'SUVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'SUVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'USVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'USVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(SHS)'
WHEN PARTY = 'USVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'USVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BPVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BPVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NCPSP'
WHEN PARTY = 'BPVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'BPVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PBVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NCPSP'
WHEN PARTY = 'PBVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'PBVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'PBVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'HUVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(SHS)'
WHEN PARTY = 'HUVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'HUVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'HUVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'UHVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'UHVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(SHS)'
WHEN PARTY = 'UHVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VBA'
WHEN PARTY = 'UHVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'UHO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'UHO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(SHS)'
WHEN PARTY = 'UHO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'HUO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(SHS)'
WHEN PARTY = 'HUO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'HUO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BUAVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BUAVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SS(UBT)'
WHEN PARTY = 'BUAVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BVA'
WHEN PARTY = 'BUAVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'VBA'
WHEN PARTY = 'BUAVO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'UBAVO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SS(UBT)'
WHEN PARTY = 'UBAVO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'UBAVO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BVA'
WHEN PARTY = 'UBAVO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'VBA'
WHEN PARTY = 'UBAVO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'MAHARA%'
  AND Campaign_Name LIKE 'MH-PP-%'
  AND Start_Time >= '2024-04-05'
  AND Start_Time < '2024-05-18'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO IN (21,22,25,27,31)
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_mp = """
WITH CTE AS
(
SELECT 
*
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY MOBILE ORDER BY STIME DESC) AS VALID_NUM
FROM
(
SELECT  --- MP
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'MADHY%'
  AND Campaign_Name LIKE 'MP-BC-PC%'
  AND PC_NO IN (14,16,24)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('MP')

UNION ALL

SELECT  -- MP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'MADHY%'
  AND Campaign_Name LIKE 'MP-BC-PC%-LSE'
  AND PC_NO IN (1,2,3,4,5,6,7,8,9,10,11,12,13,15,17,18,19,20,21,22,23,25,26,27,28,29)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('MP')

UNION ALL

SELECT  -- MP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'MADHY%'
  AND Campaign_Name LIKE 'MP-BC-PC%-PM'
  AND PC_NO IN (1,2,3,4,5,6,7,8,9,10,11,12,13,15,17,18,19,20,21,22,23,25,26,27,28,29)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('MP')

UNION ALL

SELECT 
*
FROM
(
SELECT				--- MP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'MADHY%'
  AND Campaign_Name LIKE 'MP-PP-%'
  AND Start_Time >= '2024-03-25'
  AND Start_Time < '2024-04-30'
  --AND PC_NO IN (16,1)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL

  UNION ALL

  SELECT				--- MP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AIFB'
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIFB'
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IMBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IMBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BSP'
WHEN PARTY = 'IMBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN PARTY = 'IMBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'MADHY%'
  AND Campaign_Name LIKE 'MP-PP-%'
  AND Start_Time >= '2024-03-25'
  AND Start_Time < '2024-04-30'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
  ) AS T3
  WHERE PC_NO = 1
  ) AS T4
  ) AS T5
  WHERE VALID_NUM = 1
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_od = """
WITH CTE AS
(
SELECT				--- OD
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJD'
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJD'
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BDIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BDIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJD'
WHEN SEQ = 'BDIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BDIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJD'
WHEN SEQ = 'DBIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'DBIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'DBIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BDIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'DBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Odi%'
  AND Campaign_Name LIKE 'OD-BC-PC%'
  AND PC_NO = 17
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('OD')

UNION ALL

SELECT
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJD'
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BDIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJD'
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'DBIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BDIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'DBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Odi%'
  AND Campaign_Name LIKE 'OD-BC-PC%'
  AND PC_NO <> 17
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('OD')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_pb = """
WITH CTE AS
(
SELECT 
*
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY MOBILE ORDER BY STIME DESC) AS VALID_NUM
FROM
(
SELECT  --- PB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SAD'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AAP (P)'
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'SAD'
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'SAD'
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'SAD'
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,8%' ) THEN 'BJP'
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'ASIBO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ISABO'
WHEN VENDOR_ID IN (4) THEN 'SIABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  -- PB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SAD'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'ASIBO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ISABO'
WHEN VENDOR_ID IN (4) THEN 'SIABO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  --- PB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SAD'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AAP (P)'
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'SAD'
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ASIBO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'SAD'
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'ISABO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,5%' ) THEN 'SAD'
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'SIABO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'SIABO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ISABO'
WHEN VENDOR_ID IN (4) THEN 'ASIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (3,6,8,9,10,11,12,13)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  --- PB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ASIBO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'ISABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SAD'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'SIABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'SIABO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ISABO'
WHEN VENDOR_ID IN (4) THEN 'ASIBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (3,6,8,9,10,11,12,13)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  --- PB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AAP (P)'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIASO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBASO'
WHEN VENDOR_ID IN (4) THEN 'ABISO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,2,5)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  --- PB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIASO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBASO'
WHEN VENDOR_ID IN (4) THEN 'ABISO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,2,5)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  --- PB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,8%' ) THEN 'SAD'
WHEN SEQ = 'BIASO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AAP (P)'
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,8%' ) THEN 'SAD'
WHEN SEQ = 'IBASO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AAP (P)'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,8%' ) THEN 'SAD'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIASO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBASO'
WHEN VENDOR_ID IN (4) THEN 'ABISO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (7)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  --- PB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'BIASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'IBASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIASO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBASO'
WHEN VENDOR_ID IN (4) THEN 'ABISO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (7)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('PB')

UNION ALL

SELECT  --- PB_PP
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'ISBAM' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'ISBAM' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN SEQ = 'ISBAM' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'ISBAM' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AAP (P)'
WHEN SEQ = 'ISBAM' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'BSP'
--
WHEN SEQ = 'SIBAM' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SAD'
WHEN SEQ = 'SIBAM' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'SIBAM' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'SIBAM' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AAP (P)'
WHEN SEQ = 'SIBAM' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'BSP'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'ISBAM'
WHEN VENDOR_ID IN (4) THEN 'SIBAM'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-PP-PC%'
    AND Start_Time < '2024-04-30'
  --AND PC_NO IN (4)
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL

UNION ALL

SELECT				-- PB LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN PARTY = 'BIASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN PARTY = 'BIASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'SIABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SAD'
WHEN PARTY = 'SIABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'SIABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN PARTY = 'SIABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN PARTY = 'SIABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ISABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'ISABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN PARTY = 'ISABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP (P)'
WHEN PARTY = 'ISABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN PARTY = 'ISABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ASIBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP (P)'
WHEN PARTY = 'ASIBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SAD'
WHEN PARTY = 'ASIBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'ASIBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN PARTY = 'ASIBO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND Campaign_Name LIKE 'PB-PP-%'
  AND Start_Time >= '2024-04-05'
  AND Start_Time < '2024-04-30'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
  ) AS T3
  ) AS T4
    WHERE VALID_NUM = 1

UNION ALL

SELECT				-- PB LSE/PP
*,0 AS VALID_NUM
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AAP'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN PARTY = 'IBASO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AAP'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'SAD'
WHEN PARTY = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Punjab%'
  AND ( Campaign_Name LIKE 'PB-PP%' OR Campaign_Name LIKE 'PB-AC%' )
  AND Start_Time >= '2024-04-30'
  AND Start_Time < '2024-05-17'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO = 12
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_rj = """
WITH CTE AS
(
SELECT  -- RJ
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'RAJAS%'
  AND Campaign_Name LIKE 'RJ-BC-PC%'
  AND PC_NO IN (1,6,8,10,11,12,17,18)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('RJ')

UNION ALL

SELECT  -- RJ
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'RLP'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,7%' ) THEN 'RLP'
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBRO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'RAJAS%'
  AND Campaign_Name LIKE 'RJ-BC-PC%'
  AND PC_NO IN (14)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('RJ')

UNION ALL

SELECT  -- RJ
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BTP'
WHEN SEQ = 'IBTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BTP'
WHEN SEQ = 'IBTO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBTO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'RAJAS%'
  AND Campaign_Name LIKE 'RJ-BC-PC%'
  AND PC_NO IN (20)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('RJ')

UNION ALL

SELECT  -- RJ_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Rajasthan%'
  AND Campaign_Name LIKE 'RJ-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (2,3,4,5,7,9,13,15,16,19,21,22,23,24,25)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('RJ')

UNION ALL

SELECT  -- RJ_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Rajasthan%'
  AND Campaign_Name LIKE 'RJ-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (2,3,4,5,7,9,13,15,16,19,21,22,23,24,25)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('RJ')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_tg = """
WITH CTE AS
(
SELECT -- TG
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIBR' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIBR' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIBR' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN SEQ = 'BIBR' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBRB' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBRB' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BRS'
WHEN SEQ = 'IBRB' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IBRB' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'BRBI' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BRS'
WHEN SEQ = 'BRBI' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'BRBI' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BRBI' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIBR' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIBR' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIBR' AND (  RESPONSE LIKE '%,7%' ) THEN 'BRS'
--
WHEN SEQ = 'IBRB' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBRB' AND (  RESPONSE LIKE '%,6%' ) THEN 'BRS'
WHEN SEQ = 'IBRB' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
--
WHEN SEQ = 'BRBI' AND (  RESPONSE LIKE '%,5%' ) THEN 'BRS'
WHEN SEQ = 'BRBI' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'BRBI' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIBR'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBRB'
WHEN VENDOR_ID IN (4) THEN 'BRBI'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Telangana%'
  AND Start_Time < '2024-04-01'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('TG')
AND T3.PC_NO IN (4)

UNION ALL

SELECT
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN SEQ = 'BIRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IRBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IRBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BRS'
WHEN SEQ = 'IRBO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BJP'
WHEN SEQ = 'IRBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BRS'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIRO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIRO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIRO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BRS'
WHEN SEQ = 'BIRO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IRBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IRBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BRS'
WHEN SEQ = 'IRBO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BJP'
WHEN SEQ = 'IRBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BRS'
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIRO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IRBO'
WHEN VENDOR_ID IN (4) THEN 'RBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Telangana%'
  AND Start_Time < '2024-04-01'
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('TG')
AND T3.PC_NO IN (8)

UNION ALL

SELECT  -- TG_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BRS'
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BRS'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BRIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BRIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BRS'
WHEN SEQ = 'BRIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BRIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BRS'
WHEN SEQ = 'IBRO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BRS'
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'RBIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BRIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBRO'
WHEN VENDOR_ID IN (4) THEN 'RBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Telangana%'
  AND Campaign_Name LIKE 'TG-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,2,3,5,6,7,10,11,12,13,14,15,16,17)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('TG')

UNION ALL

SELECT  -- TG_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BRS'
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BRIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN SEQ = 'IBRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BRS'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'RBIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BRIO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBRO'
WHEN VENDOR_ID IN (4) THEN 'RBIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Telangana%'
  AND Campaign_Name LIKE 'TG-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,2,3,5,6,7,10,11,12,13,14,15,16,17)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('TG')

UNION ALL

SELECT  -- TG_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BRS'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIMIM'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIMIM'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BRS'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIMIM'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BRIAO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BRIAO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BRS'
WHEN SEQ = 'BRIAO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BRIAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'AIMIM'
WHEN SEQ = 'BRIAO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBRAO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBRAO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBRAO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BRS'
WHEN SEQ = 'IBRAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'AIMIM'
WHEN SEQ = 'IBRAO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIAO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BRS'
WHEN SEQ = 'RBIAO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'RBIAO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'RBIAO' AND (  RESPONSE LIKE '%,8%' ) THEN 'AIMIM'
WHEN SEQ = 'RBIAO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BRIAO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBRAO'
WHEN VENDOR_ID IN (4) THEN 'RBIAO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Telangana%'
  AND Campaign_Name LIKE 'TG-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('TG')

UNION ALL

SELECT  -- TG_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BRS'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIMIM'
WHEN SEQ = 'BRIAO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIMIM'
WHEN SEQ = 'IBRAO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BRS'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIMIM'
WHEN SEQ = 'RBIAO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BRIAO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBRAO'
WHEN VENDOR_ID IN (4) THEN 'RBIAO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Telangana%'
  AND Campaign_Name LIKE 'TG-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (9)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('TG')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_uk = """
WITH CTE AS
(
SELECT  --- UK_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttarakhand%'
  AND Campaign_Name LIKE 'UK-BC-PC%-LSE'
  AND PC_NO IN (1,2,3,4,5)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UK')

UNION ALL

SELECT  -- UK_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttarakhand%'
  AND Campaign_Name LIKE 'UK-BC-PC%-PM'
  AND PC_NO IN (1,2,3,4,5)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UK')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_up = """
WITH CTE AS
(
SELECT  --- UP
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BMS' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BMS' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BSPM'
WHEN SEQ = 'BMS' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'SP'
WHEN SEQ = 'BMS' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'MBS' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BSPM'
WHEN SEQ = 'MBS' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'MBS' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'SP'
WHEN SEQ = 'MBS' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBM' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SBM' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'SBM' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSPM'
WHEN SEQ = 'SBM' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BMS' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BMS' AND (  RESPONSE LIKE '%,6%' ) THEN 'BSPM'
WHEN SEQ = 'BMS' AND (  RESPONSE LIKE '%,7%' ) THEN 'SP'
WHEN SEQ = 'BMS' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'MBS' AND (  RESPONSE LIKE '%,5%' ) THEN 'BSPM'
WHEN SEQ = 'MBS' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'MBS' AND (  RESPONSE LIKE '%,7%' ) THEN 'SP'
WHEN SEQ = 'MBS' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBM' AND (  RESPONSE LIKE '%,5%' ) THEN 'SP'
WHEN SEQ = 'SBM' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'SBM' AND (  RESPONSE LIKE '%,7%' ) THEN 'BSPM'
WHEN SEQ = 'SBM' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BMS'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'MBS'
WHEN VENDOR_ID IN (4) THEN 'SBM'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTAR%'
  AND Start_Time < '2024-03-25'
  AND PC_NO = 52
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,14,66,67)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,14,66,67)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BSMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BSMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'SP'
WHEN SEQ = 'BSMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'SP'
WHEN SEQ = 'SBMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'SBMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BSMO'
WHEN VENDOR_ID IN (4) THEN 'SBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (2,6,7,8,20,21,22,23,25,26,28,31,33,35,41,42,48,50,51,54,56,59,64,65,69,72,76,77)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BSMO'
WHEN VENDOR_ID IN (4) THEN 'SBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (2,6,7,8,20,21,22,23,25,26,28,31,33,35,41,42,48,50,51,54,56,59,64,65,69,72,76,77)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BSMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BSMO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BSP'
WHEN SEQ = 'BSMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'SBMO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BSP'
WHEN SEQ = 'SBMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BSMO'
WHEN VENDOR_ID IN (4) THEN 'SBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (5,9,10,13,15,18,24,27,29,30,32,34,38,39,40,44,45,47,49,55,57,58,60,61,68,71,73,74,75,78)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BSMO'
WHEN VENDOR_ID IN (4) THEN 'SBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (5,9,10,13,15,18,24,27,29,30,32,34,38,39,40,44,45,47,49,55,57,58,60,61,68,71,73,74,75,78)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'SP'
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'SP'
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (12,16,46,52,53,63)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (12,16,46,52,53,63)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (19,36,37,43)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (19,36,37,43)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'SRMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SRMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RLD'
WHEN SEQ = 'SRMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SRMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'RSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RLD'
WHEN SEQ = 'RSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN SEQ = 'RSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'RSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (4) THEN 'SRMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'RSMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (4,11)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BSMO'
WHEN VENDOR_ID IN (4) THEN 'SBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (3)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BIMO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'IBMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (17)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'PSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SBSP'
WHEN SEQ = 'PSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN SEQ = 'PSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'PSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SPMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SPMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SBSP'
WHEN SEQ = 'SPMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SPMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'PSMO'
WHEN VENDOR_ID IN (4) THEN 'SPMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (70)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NP'
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NP'
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BNMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BNMO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BSP'
WHEN SEQ = 'BNMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'SNMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'SNMO' AND (  RESPONSE LIKE '%,7%' ) THEN 'BSP'
WHEN SEQ = 'SNMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
--WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BNMO'
WHEN VENDOR_ID IN (4) THEN 'SNMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (62)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NP'
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BNMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'NP'
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SNMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
--WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BNMO'
WHEN VENDOR_ID IN (4) THEN 'SNMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (62)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'ADS'
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'ADS'
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'ADS'
WHEN SEQ = 'BAMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'SAMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'SP'
WHEN SEQ = 'SAMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'ADS'
WHEN SEQ = 'SAMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
--WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAMO'
WHEN VENDOR_ID IN (4) THEN 'SAMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (79,80)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT  --- UP_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'ADS'
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'BAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'ADS'
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN SEQ = 'SAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
--WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAMO'
WHEN VENDOR_ID IN (4) THEN 'SAMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Uttar%'
  AND Campaign_Name LIKE 'UP-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (79,80)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('UP')

UNION ALL

SELECT				-- UP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RLD'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RLD'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SBSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SBSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AD'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AD'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTAR%'
  AND Campaign_Name LIKE 'UP-PP-%'
  AND Start_Time >= '2024-04-05'
  AND Start_Time < '2024-05-16'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO = 37

  UNION ALL

  SELECT * FROM
(
SELECT				-- UP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RLD'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RLD'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SBSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SBSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AD'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AD'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTAR%'
  AND Campaign_Name LIKE 'UP-PP-%'
  AND Start_Time >= '2024-04-05'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO <> 37

  UNION ALL

SELECT				-- UP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RLD'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RLD'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SBSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SBSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AD'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AD'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTAR%'
  AND Campaign_Name LIKE 'UP-PP-%'
  AND Start_Time >= '2024-05-16'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO = 37
  ) AS T3 WHERE PC_NO IN (79,80) AND STIME < '2024-05-25'
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
bc_wb = """
WITH CTE AS
(
SELECT  -- WB
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPIM'
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPIM'
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BTCO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'TBCO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND state LIKE 'WEST%'
  AND PC_NO = 15
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN SEQ = 'BTCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN SEQ = 'TBCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN SEQ = 'CBTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN SEQ = 'CBTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'CBTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AITC'
WHEN SEQ = 'CBTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPIM'
WHEN SEQ = 'BTCO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,7%' ) THEN 'CPIM'
WHEN SEQ = 'TBCO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN SEQ = 'CBTO' AND (  RESPONSE LIKE '%,5%' ) THEN 'CPIM'
WHEN SEQ = 'CBTO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'CBTO' AND (  RESPONSE LIKE '%,7%' ) THEN 'AITC'
WHEN SEQ = 'CBTO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BTCO'
WHEN VENDOR_ID IN (2,5,6,8) THEN 'TBCO'
WHEN VENDOR_ID IN (4) THEN 'CBTO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND state LIKE 'WEST%'
  AND PC_NO = 29
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAIMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAIMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BAIMO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BAIMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'CPIM'
WHEN SEQ = 'BAIMO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'ABIMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABIMO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABIMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'CPIM'
WHEN SEQ = 'ABIMO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIMO'
WHEN VENDOR_ID IN (4) THEN 'ABIMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (3,4,5,7,9,11,12,13,14,16,20,22,23,24,25,26,27,28,30,31,36,37,38,39,40,41,42)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN SEQ = 'BAIMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN SEQ = 'ABIMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIMO'
WHEN VENDOR_ID IN (4) THEN 'ABIMO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (3,4,5,7,9,11,12,13,14,16,20,22,23,24,25,26,27,28,30,31,36,37,38,39,40,41,42)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAIRO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAIRO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BAIRO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BAIRO' AND (  RESPONSE LIKE '%,8%' ) THEN 'RSP'
WHEN SEQ = 'BAIRO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIRO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'ABIRO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABIRO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABIRO' AND (  RESPONSE LIKE '%,8%' ) THEN 'RSP'
WHEN SEQ = 'ABIRO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIRO'
WHEN VENDOR_ID IN (4) THEN 'ABIRO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (2,6,10,19)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN SEQ = 'BAIRO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN SEQ = 'ABIRO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIRO'
WHEN VENDOR_ID IN (4) THEN 'ABIRO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (2,6,10,19)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAIFO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAIFO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BAIFO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BAIFO' AND (  RESPONSE LIKE '%,8%' ) THEN 'AIFB'
WHEN SEQ = 'BAIFO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIFO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'ABIFO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABIFO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABIFO' AND (  RESPONSE LIKE '%,8%' ) THEN 'AIFB'
WHEN SEQ = 'ABIFO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIFO'
WHEN VENDOR_ID IN (4) THEN 'ABIFO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (1,17,35)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN SEQ = 'BAIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN SEQ = 'ABIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIFO'
WHEN VENDOR_ID IN (4) THEN 'ABIFO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (1,17,35)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAICO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAICO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BAICO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BAICO' AND (  RESPONSE LIKE '%,8%' ) THEN 'CPI'
WHEN SEQ = 'BAICO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABICO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'ABICO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABICO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABICO' AND (  RESPONSE LIKE '%,8%' ) THEN 'CPI'
WHEN SEQ = 'ABICO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAICO'
WHEN VENDOR_ID IN (4) THEN 'ABICO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (18,32,34)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN SEQ = 'BAICO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN SEQ = 'ABICO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAICO'
WHEN VENDOR_ID IN (4) THEN 'ABICO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (18,32,34)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'IFS'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'IFS'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAISO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAISO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BAISO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BAISO' AND (  RESPONSE LIKE '%,8%' ) THEN 'IFS'
WHEN SEQ = 'BAISO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,8%' ) THEN 'IFS'
WHEN SEQ = 'ABISO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAISO'
WHEN VENDOR_ID IN (4) THEN 'ABISO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (21)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'IFS'
WHEN SEQ = 'BAISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'IFS'
WHEN SEQ = 'ABISO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAISO'
WHEN VENDOR_ID IN (4) THEN 'ABISO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (21)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_LSE
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN SEQ = 'BAIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN SEQ = 'BAIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'AITC'
WHEN SEQ = 'BAIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'BAIO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'AITC'
WHEN SEQ = 'ABIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN SEQ = 'ABIO' AND (  RESPONSE LIKE '%,7%' ) THEN 'INC'
WHEN SEQ = 'ABIO' AND (  RESPONSE LIKE '%,9%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIO'
WHEN VENDOR_ID IN (4) THEN 'ABIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'LSE_2019'
  AND PC_NO IN (8)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB_PM
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIO'
WHEN VENDOR_ID IN (4) THEN 'ABIO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
  AND Q2_Type = 'PM_2024'
  AND PC_NO IN (8)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')

UNION ALL

SELECT  -- WB
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'BAIJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BAIJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN SEQ = 'BAIJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'BAIJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'JMM'
WHEN SEQ = 'BAIJO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABIJO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN SEQ = 'ABIJO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABIJO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN SEQ = 'ABIJO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'JMM'
WHEN SEQ = 'ABIJO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN (1,3,7,9,10,11) THEN 'BAIJO'
WHEN VENDOR_ID IN (4) THEN 'ABIJO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'West_Bengal%'
  AND Campaign_Name LIKE 'WB-BC-PC%'
--  AND Start_Time < '2024-03-15'
  --AND Q2_Type = 'PM_2024'
  AND PC_NO IN (33)
  GROUP BY DN
) AS T1
) AS T2
) AS T3 LEFT OUTER JOIN INDIA_Data B ON T3.AC_NO = B.AC_NO
WHERE T3.RES1 IS NOT NULL AND T3.RES1 <> ''
AND B.State_Code IN ('WB')
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
