pp_ap = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'TYIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'TDP+'
WHEN N_PARTY = 'TYIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'YSRCP'
WHEN N_PARTY = 'TYIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'TYIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'YTIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'YSRCP'
WHEN N_PARTY = 'YTIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'TDP+'
WHEN N_PARTY = 'YTIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'YTIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BYIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BYIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'YSRCP'
WHEN N_PARTY = 'BYIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'BYIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'YBIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'YSRCP'
WHEN N_PARTY = 'YBIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'YBIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'YBIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BYMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BYMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'YSRCP'
WHEN N_PARTY = 'BYMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'BYMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'YBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'YSRCP'
WHEN N_PARTY = 'YBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'YBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'YBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'TYCO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'TDP+'
WHEN N_PARTY = 'TYCO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'YSRCP'
WHEN N_PARTY = 'TYCO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPI'
WHEN N_PARTY = 'TYCO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'YTCO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'YSRCP'
WHEN N_PARTY = 'YTCO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'TDP+'
WHEN N_PARTY = 'YTCO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPI'
WHEN N_PARTY = 'YTCO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JYIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JSP'
WHEN N_PARTY = 'JYIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'YSRCP'
WHEN N_PARTY = 'JYIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'JYIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'YJIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'YSRCP'
WHEN N_PARTY = 'YJIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JSP'
WHEN N_PARTY = 'YJIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'YJIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'AP-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_asm = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BJO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BJO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AJP'
WHEN N_PARTY = 'BJO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AJP'
WHEN N_PARTY = 'JBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'JBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IUO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IUO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'UPPL'
WHEN N_PARTY = 'IUO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'UPPL'
WHEN N_PARTY = 'UIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'UIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'GIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AGP'
WHEN N_PARTY = 'GIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'GIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IGO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IGO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AGP'
WHEN N_PARTY = 'IGO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AIUDF'
WHEN N_PARTY = 'ABIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'ABIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AIUDF'
WHEN N_PARTY = 'BIAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AIUDF'
WHEN N_PARTY = 'IBAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'AGIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AIUDF'
WHEN N_PARTY = 'AGIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AGP'
WHEN N_PARTY = 'AGIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'AGIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'GIAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AGP'
WHEN N_PARTY = 'GIAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'GIAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AIUDF'
WHEN N_PARTY = 'GIAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IGAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IGAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AGP'
WHEN N_PARTY = 'IGAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AIUDF'
WHEN N_PARTY = 'IGAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'PUISO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BPF'
WHEN N_PARTY = 'PUISO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'UPPL'
WHEN N_PARTY = 'PUISO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'PUISO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'GSP'
WHEN N_PARTY = 'PUISO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UPISO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'UPPL'
WHEN N_PARTY = 'UPISO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BPF'
WHEN N_PARTY = 'UPISO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'UPISO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'GSP'
WHEN N_PARTY = 'UPISO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'AS-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_br = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RJD'
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RJD'
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'HRMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'HAM'
WHEN N_PARTY = 'HRMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RJD'
WHEN N_PARTY = 'HRMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'HRMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RHMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RJD'
WHEN N_PARTY = 'RHMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'HAM'
WHEN N_PARTY = 'RHMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'RHMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'LRMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'LJP'
WHEN N_PARTY = 'LRMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RJD'
WHEN N_PARTY = 'LRMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'LRMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RLMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RJD'
WHEN N_PARTY = 'RLMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'LJP'
WHEN N_PARTY = 'RLMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'RLMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RJMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RJD'
WHEN N_PARTY = 'RJMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JDU'
WHEN N_PARTY = 'RJMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'RJMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JRMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JDU'
WHEN N_PARTY = 'JRMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RJD'
WHEN N_PARTY = 'JRMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'JRMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JIMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JDU'
WHEN N_PARTY = 'JIMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'JIMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'JIMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IJMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IJMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JDU'
WHEN N_PARTY = 'IJMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'IJMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BCMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BCMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'CPI'
WHEN N_PARTY = 'BCMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'BCMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'CBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPI'
WHEN N_PARTY = 'CBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'CBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'CBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'LPMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'LJP'
WHEN N_PARTY = 'LPMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'CPIM'
WHEN N_PARTY = 'LPMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'LPMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'PLMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPIM'
WHEN N_PARTY = 'PLMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'LJP'
WHEN N_PARTY = 'PLMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'PLMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JVMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JDU'
WHEN N_PARTY = 'JVMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'VIP'
WHEN N_PARTY = 'JVMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'JVMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'VJMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'VIP'
WHEN N_PARTY = 'VJMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JDU'
WHEN N_PARTY = 'VJMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'VJMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JXMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JDU'
WHEN N_PARTY = 'JXMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'CPI(ML)'
WHEN N_PARTY = 'JXMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'JXMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'XJMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPI(ML)'
WHEN N_PARTY = 'XJMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JDU'
WHEN N_PARTY = 'XJMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'XJMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BXMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BXMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'CPI(ML)'
WHEN N_PARTY = 'BXMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'BXMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'XBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPI(ML)'
WHEN N_PARTY = 'XBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'XBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'XBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'XYMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPI(ML)'
WHEN N_PARTY = 'XYMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RLM'
WHEN N_PARTY = 'XYMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'XYMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'YXMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RLM'
WHEN N_PARTY = 'YXMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'CPI(ML)'
WHEN N_PARTY = 'YXMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'YXMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BVMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BVMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'VIP'
WHEN N_PARTY = 'BVMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'BVMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'VBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'VIP'
WHEN N_PARTY = 'VBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'VBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'VBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ILMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'ILMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'LJP'
WHEN N_PARTY = 'ILMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'ILMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'LIMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'LJP'
WHEN N_PARTY = 'LIMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'LIMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'LIMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RJMNO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RJD'
WHEN N_PARTY = 'RJMNO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JDU'
WHEN N_PARTY = 'RJMNO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'RJMNO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'IND'
WHEN N_PARTY = 'RJMNO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JRMNO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JDU'
WHEN N_PARTY = 'JRMNO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RJD'
WHEN N_PARTY = 'JRMNO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BSP'
WHEN N_PARTY = 'JRMNO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'IND'
WHEN N_PARTY = 'JRMNO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'BR-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_cg = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'CG-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_ch =  """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN N_PARTY IN ('BIO') AND (  DTMF_REP LIKE '%,5%' ) THEN 'BJP'
WHEN N_PARTY IN ('BIO') AND (  DTMF_REP LIKE '%,6%' ) THEN 'INC'
WHEN N_PARTY IN ('BIO') AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN N_PARTY IN ('IBO') AND (  DTMF_REP LIKE '%,5%' ) THEN 'INC'
WHEN N_PARTY IN ('IBO') AND (  DTMF_REP LIKE '%,6%' ) THEN 'BJP'
WHEN N_PARTY IN ('IBO') AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'CH-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_dl = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALIDX
FROM 
(
SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AAP'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'DL-PP%'
AND Start_Time < '2024-05-23'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'AAP'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'BJP'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'BJP'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'AAP'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'DL-PP%'
AND Start_Time >= '2024-05-23'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
) AS T1 
) AS T2
WHERE VALIDX = 1
"""

pp_ga = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'GA-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_gj = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AAP'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN N_PARTY IN ('BIO','BAO') AND (  DTMF_REP LIKE '%,5%' ) THEN 'BJP'
WHEN N_PARTY IN ('BIO','BAO') AND (  DTMF_REP LIKE '%,6%' ) THEN 'INC'
WHEN N_PARTY IN ('BIO','BAO') AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN N_PARTY IN ('IBO','ABO') AND (  DTMF_REP LIKE '%,5%' ) THEN 'INC'
WHEN N_PARTY IN ('IBO','ABO') AND (  DTMF_REP LIKE '%,6%' ) THEN 'BJP'
WHEN N_PARTY IN ('IBO','ABO') AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'GJ-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_hp = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'HP-PP%'
AND Campaign_Name NOT LIKE 'HP-PP-AC%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_hr = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALIDX
FROM 
(
SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'JJP'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'INLD'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'JJP'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'INLD'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'JJP'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'INLD'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AAP'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'JJP'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'INLD'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'HR-PP%'
AND Start_Time < '2024-05-22'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'INC'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'BJP'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JJP'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INLD'
WHEN N_PARTY = 'IBJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'AAP'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'BJP'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JJP'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INLD'
WHEN N_PARTY = 'ABJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'BJP'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'INC'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JJP'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INLD'
WHEN N_PARTY = 'BIJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'BJP'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'AAP'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JJP'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INLD'
WHEN N_PARTY = 'BAJLO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'HR-PP%'
AND Start_Time >= '2024-05-22'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
) AS T1 
) AS T2
WHERE VALIDX = 1
"""

pp_jh = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BJO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BJO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JMM'
WHEN N_PARTY = 'BJO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JMM'
WHEN N_PARTY = 'JBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'JBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BRO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BRO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RJD'
WHEN N_PARTY = 'BRO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RJD'
WHEN N_PARTY = 'RBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'RBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BCO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BCO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'CPI (ML)'
WHEN N_PARTY = 'BCO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'CBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPI (ML)'
WHEN N_PARTY = 'CBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'CBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'AJO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AJSUP'
WHEN N_PARTY = 'AJO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JMM'
WHEN N_PARTY = 'AJO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JMM'
WHEN N_PARTY = 'JAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AJSUP'
WHEN N_PARTY = 'JAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'JH-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_ka = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'JDS'
WHEN N_PARTY = 'JIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'JIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IJO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IJO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'JDS'
WHEN N_PARTY = 'IJO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'KA-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_kl = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'BIMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'IBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'MIBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPIM'
WHEN N_PARTY = 'MIBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'MIBO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'MIBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BICO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BICO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BICO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPI'
WHEN N_PARTY = 'BICO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'CIBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPI'
WHEN N_PARTY = 'CIBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'CIBO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'CIBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBCO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBCO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBCO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPI'
WHEN N_PARTY = 'IBCO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RSP'
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'BRMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RSP'
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'RBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'MRBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPIM'
WHEN N_PARTY = 'MRBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RSP'
WHEN N_PARTY = 'MRBO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'MRBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BUMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BUMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'IUML'
WHEN N_PARTY = 'BUMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'BUMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UBMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'IUML'
WHEN N_PARTY = 'UBMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'UBMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'UBMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'MUBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPIM'
WHEN N_PARTY = 'MUBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'IUML'
WHEN N_PARTY = 'MUBO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'MUBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'CIDO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPI'
WHEN N_PARTY = 'CIDO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'CIDO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BDJS'
WHEN N_PARTY = 'CIDO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DICO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BDJS'
WHEN N_PARTY = 'DICO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'DICO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPI'
WHEN N_PARTY = 'DICO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IDCO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IDCO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BDJS'
WHEN N_PARTY = 'IDCO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPI'
WHEN N_PARTY = 'IDCO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DIMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BDJS'
WHEN N_PARTY = 'DIMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'DIMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'DIMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IDMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IDMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BDJS'
WHEN N_PARTY = 'IDMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'CPIM'
WHEN N_PARTY = 'IDMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'MIDO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'CPIM'
WHEN N_PARTY = 'MIDO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'MIDO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BDJS'
WHEN N_PARTY = 'MIDO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DJKO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BDJS'
WHEN N_PARTY = 'DJKO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'KC (J)'
WHEN N_PARTY = 'DJKO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'KC (M)'
WHEN N_PARTY = 'DJKO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'JDKO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'KC (J)'
WHEN N_PARTY = 'JDKO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BDJS'
WHEN N_PARTY = 'JDKO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'KC (M)'
WHEN N_PARTY = 'JDKO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'KJDO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'KC (M)'
WHEN N_PARTY = 'KJDO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'KC (J)'
WHEN N_PARTY = 'KJDO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BDJS'
WHEN N_PARTY = 'KJDO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'KL-PP%'
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
"""

pp_mh = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALIDX
FROM 
(
SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'BIVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'IBVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ISVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'ISVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'ISVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'ISVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'SIVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'SIVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'SIVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SUO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'SUO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'SUO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'USO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'USO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'USO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'SIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'SIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ISO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'ISO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'ISO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BPO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BPO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'NCPSP'
WHEN N_PARTY = 'BPO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'PBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'NCPSP'
WHEN N_PARTY = 'PBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'PBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BUO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BUO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'BUO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'UBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'NPO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'NCP'
WHEN N_PARTY = 'NPO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'NCPSP'
WHEN N_PARTY = 'NPO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'PNO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'NCPSP'
WHEN N_PARTY = 'PNO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'NCP'
WHEN N_PARTY = 'PNO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'NUO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'NCP'
WHEN N_PARTY = 'NUO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'NUO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UNO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UNO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'NCP'
WHEN N_PARTY = 'UNO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'NPVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'NCP'
WHEN N_PARTY = 'NPVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'NCPSP'
WHEN N_PARTY = 'NPVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'NPVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'PNVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'NCPSP'
WHEN N_PARTY = 'PNVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'NCP'
WHEN N_PARTY = 'PNVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'PNVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'RUVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'RSPS'
WHEN N_PARTY = 'RUVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'RUVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'RUVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'URVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'URVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'RSPS'
WHEN N_PARTY = 'URVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'URVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SUVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'SUVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'SUVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'SUVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'USVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'USVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'USVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'USVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BPVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BPVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'NCPSP'
WHEN N_PARTY = 'BPVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'BPVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'PBVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'NCPSP'
WHEN N_PARTY = 'PBVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'PBVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'PBVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UHO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UHO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'UHO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'HUO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'HUO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'HUO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BVA'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'VBA'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BVA'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'VBA'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'MH-PP%'
AND PC_NO NOT IN (21,22,25,27,31)
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'HUVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'VBA'
WHEN N_PARTY = 'UHVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UHO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UHO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'UHO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'HUO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(SHS)'
WHEN N_PARTY = 'HUO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'HUO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BVA'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'VBA'
WHEN N_PARTY = 'BUAVO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SS(UBT)'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BVA'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'VBA'
WHEN N_PARTY = 'UBAVO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'MH-PP%'
AND PC_NO IN (21,22,25,27,31)
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
) AS T1 
) AS T2
WHERE VALIDX = 1
"""

pp_mp = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALIDX
FROM 
(
SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'BJP'
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'INC'
WHEN N_PARTY = 'BIO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'INC'
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'BJP'
WHEN N_PARTY = 'IBO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'MP-PP%'
AND PC_NO <> 1
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AIFB'
WHEN N_PARTY = 'BAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AIFB'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BSP'
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'MP-PP%'
AND PC_NO <> 1
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BSP'
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'IMBO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'MBIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BSP'
WHEN N_PARTY = 'MBIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'MBIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'MBIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'MP-PP%'
AND PC_NO = 1
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
) AS T1 
) AS T2
WHERE VALIDX = 1
"""

pp_od = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALIDX
FROM 
(
SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJD'
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJD'
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN N_PARTY = 'BDIO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'BJP'
WHEN N_PARTY = 'BDIO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'BJD'
WHEN N_PARTY = 'BDIO' AND (  DTMF_REP LIKE '%,7%' ) THEN 'INC'
WHEN N_PARTY = 'BDIO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DBIO' AND (  DTMF_REP LIKE '%,5%' ) THEN 'BJD'
WHEN N_PARTY = 'DBIO' AND (  DTMF_REP LIKE '%,6%' ) THEN 'BJP'
WHEN N_PARTY = 'DBIO' AND (  DTMF_REP LIKE '%,7%' ) THEN 'INC'
WHEN N_PARTY = 'DBIO' AND (  DTMF_REP LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'OD-PP%'
AND PC_NO IN (17)
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJD'
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'BDIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJD'
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'DBIO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BDJO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BDJO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJD'
WHEN N_PARTY = 'BDJO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'JMM'
WHEN N_PARTY = 'BDJO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DBJO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJD'
WHEN N_PARTY = 'DBJO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'DBJO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'JMM'
WHEN N_PARTY = 'DBJO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE Campaign_Name LIKE 'OD-PP%'
AND PC_NO NOT IN (17)
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
) AS T1 
) AS T2
WHERE VALIDX = 1
"""

pp_pb = """
SELECT 
DN,
CAST(Start_Time AS date) AS Start_Time,
DTMF_REP,
state,
ST_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
ST_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
PC_NO,
PART_NO,
GENDER,
AGE,
N_PARTY,
RES1,
RES2,
CASTE
FROM
(
SELECT 
*,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALIDX
FROM 
(
SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SAD'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'AAP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SAD'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'AAP'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SAD(A)'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BJP'
--
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD(A)'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BJP'
--
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD(A)'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BJP'
--
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD(A)'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'INC'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE ( Campaign_Name LIKE 'PB-PP%' OR Campaign_Name LIKE 'PB-AC%' )
AND Start_Time < '2024-05-21' AND PC_NO <> 12
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SAD'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'AAP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'ABISMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'BIASMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'IBASMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SAD'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'AAP'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BSP'
WHEN N_PARTY = 'SIBAMO' AND ( DTMF_REP LIKE '0,%' OR DTMF_REP LIKE '0' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SAD(A)'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'DIASB' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BJP'
--
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD(A)'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'IDASB' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BJP'
--
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD(A)'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'ADISB' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'BJP'
--
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD(A)'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'BDASI' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'INC'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE ( Campaign_Name LIKE 'PB-PP%' OR Campaign_Name LIKE 'PB-AC%' )
AND Start_Time < '2024-05-21' AND PC_NO = 12
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'INC'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'BJP'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'AAP'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'BJP'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'BJP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'INC'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'SAD'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '3,%' OR DTMF_REP LIKE '3' ) THEN 'SAD'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '4,%' OR DTMF_REP LIKE '4' ) THEN 'INC'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'AAP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE ( Campaign_Name LIKE 'PB-PP%' OR Campaign_Name LIKE 'PB-AC%' )
AND Start_Time >= '2024-05-21' AND PC_NO = 7
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1

UNION ALL

SELECT 
*
FROM 
(
SELECT 
LEFT(Campaign_Name,2) AS ST_CODE,
*,
CASE
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'INC'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'IBASO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'AAP'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'BJP'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'INC'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'ABISO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'BJP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'AAP'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'SAD'
WHEN N_PARTY = 'BIASO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
--
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '5,%' OR DTMF_REP LIKE '5' ) THEN 'SAD'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '6,%' OR DTMF_REP LIKE '6' ) THEN 'INC'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '7,%' OR DTMF_REP LIKE '7' ) THEN 'BJP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '8,%' OR DTMF_REP LIKE '8' ) THEN 'AAP'
WHEN N_PARTY = 'SIBAO' AND ( DTMF_REP LIKE '9,%' OR DTMF_REP LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2,
ROW_NUMBER() OVER (PARTITION BY DN ORDER BY Start_Time DESC) AS VALID
FROM ac_data_response WHERE ( Campaign_Name LIKE 'PB-PP%' OR Campaign_Name LIKE 'PB-AC%' )
AND Start_Time >= '2024-05-29' AND PC_NO IN (6,8)
) AS T1 
WHERE RES1 IS NOT NULL AND VALID = 1
) AS T1 
) AS T2
WHERE VALIDX = 1
"""

pp_rj = """
WITH CTE AS
(
SELECT				-- RJ LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'RBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RLP'
WHEN PARTY = 'RBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'RBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'RBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BRMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BRMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RLP'
WHEN PARTY = 'BRMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BRMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BINO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BINO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BINO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'IND'
WHEN PARTY = 'BINO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'IND'
WHEN PARTY = 'IBNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'NBIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'IND'
WHEN PARTY = 'NBIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'NBIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'NBIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BCMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BCMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN PARTY = 'BCMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BCMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'CBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN PARTY = 'CBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'CBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'CBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BAP'
WHEN PARTY = 'BAO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BAP'
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
CASE
WHEN PARTY = 'IBMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN PARTY = 'IBMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN PARTY = 'IBMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN PARTY = 'BIMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN PARTY = 'BIMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN PARTY = 'BIO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'BINO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN PARTY = 'BINO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN PARTY = 'BINO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBNO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN PARTY = 'IBNO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN PARTY = 'IBNO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'BCMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'BJP'
WHEN PARTY = 'BCMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'INC'
WHEN PARTY = 'BCMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
--
WHEN PARTY = 'CBMO' AND (  RESPONSE LIKE '%,5%' ) THEN 'INC'
WHEN PARTY = 'CBMO' AND (  RESPONSE LIKE '%,6%' ) THEN 'BJP'
WHEN PARTY = 'CBMO' AND (  RESPONSE LIKE '%,8%' ) THEN 'OTHERS'
ELSE NULL END AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Rajasth%'
  AND Campaign_Name LIKE 'RJ-PP-%'
  AND Start_Time >= '2024-03-25'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""

pp_tg = """
WITH CTE AS
(
SELECT			--- TG LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN PARTY = 'BIRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN PARTY = 'IBRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIMIM'
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AIMIM'
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BRS'
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'TELAN%'
  AND Campaign_Name LIKE 'TG-PP-%'
  AND Start_Time >= '2024-04-05'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""

pp_tn = """
WITH CTE AS
(
SELECT  --- TN_LSE/PP
T3.*
FROM
(
SELECT 
*,
CASE
WHEN SEQ = 'NDABO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'NTK'
WHEN SEQ = 'NDABO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN SEQ = 'NDABO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'NDABO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'BJP'
WHEN SEQ = 'NDABO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'ABDNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'DBANO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AIADMK'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN SEQ = 'BADNO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
CASE
WHEN VENDOR_ID IN ('2') THEN 'NDABO'
WHEN VENDOR_ID IN ('4') THEN 'ABDNO'
WHEN VENDOR_ID IN ('5') THEN 'DBANO'
WHEN VENDOR_ID IN ('9') THEN 'BADNO'
ELSE 'SET_SEQ' END AS SEQ
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
,MAX([VENDOR_ID]) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([PARTY]) AS [PARTY]
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'Tamil%'
  AND Campaign_Name LIKE 'TN-%'
  AND Start_Time >= '2024-03-22'
  AND Start_Time < '2024-04-01'
  --AND Q2_Type = 'LSE_2019'
  AND PC_NO IN ('20')
  GROUP BY DN
) AS T1
) AS T2
) AS T3
WHERE RES1 IS NOT NULL
AND MOBILE NOT IN
(
SELECT				-- TN LSE/PP
MOBILE
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'TAMIL%'
  AND Campaign_Name LIKE 'TN-PP-%'
  AND Start_Time >= '2024-04-05'
  AND PC_NO IN (20)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
)

UNION ALL

SELECT				-- TN LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'TAMIL%'
  AND Campaign_Name LIKE 'TN-PP-%'
  AND Start_Time >= '2024-04-05'
  AND PC_NO IN (20)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL

  UNION ALL

SELECT				-- TN LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'TAMIL%'
  AND Campaign_Name LIKE 'TN-PP-%'
  AND Start_Time >= '2024-04-05'
  AND PC_NO IN (3,19,37)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL

  UNION ALL

  SELECT				-- TN LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'TAMIL%'
  AND Campaign_Name LIKE 'TN-PP-%'
  AND Start_Time >= '2024-04-05'
  AND PC_NO IN (38,39)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL

  UNION ALL

  SELECT				-- TN LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BDATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'DBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'ABDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BIATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'IBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BIXTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIXTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIXTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMDK'
WHEN PARTY = 'BIXTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BIXTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBXTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBXTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBXTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMDK'
WHEN PARTY = 'IBXTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'IBXTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BDXTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BDXTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'DMK'
WHEN PARTY = 'BDXTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMDK'
WHEN PARTY = 'BDXTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BDXTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'DBXTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMK'
WHEN PARTY = 'DBXTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'DBXTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMDK'
WHEN PARTY = 'DBXTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'DBXTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'XBDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMDK'
WHEN PARTY = 'XBDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'XBDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'XBDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'XBDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'AZDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'AZDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'TMC(M)'
WHEN PARTY = 'AZDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'AZDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'AZDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'APDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'APDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'PMK'
WHEN PARTY = 'APDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'APDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'APDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'APVTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'APVTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'PMK'
WHEN PARTY = 'APVTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'VCK'
WHEN PARTY = 'APVTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'APVTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABCTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'ABCTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABCTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPI'
WHEN PARTY = 'ABCTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'ABCTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'CBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPI'
WHEN PARTY = 'CBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'CBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'CBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'CBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BCATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BCATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPI'
WHEN PARTY = 'BCATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BCATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BCATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'APMTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'APMTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'PMK'
WHEN PARTY = 'APMTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN PARTY = 'APMTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'APMTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'AKYTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'AKYTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AMMK'
WHEN PARTY = 'AKYTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'MDMK'
WHEN PARTY = 'AKYTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'AKYTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'IPXTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IPXTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'PMK'
WHEN PARTY = 'IPXTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMDK'
WHEN PARTY = 'IPXTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'IPXTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'IPATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IPATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'PMK'
WHEN PARTY = 'IPATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'IPATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'IPATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'XBCTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'DMDK'
WHEN PARTY = 'XBCTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'XBCTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPI'
WHEN PARTY = 'XBCTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'XBCTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'CBXTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPI'
WHEN PARTY = 'CBXTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'CBXTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMDK'
WHEN PARTY = 'CBXTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'CBXTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BCXTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BCXTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPI'
WHEN PARTY = 'BCXTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMDK'
WHEN PARTY = 'BCXTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BCXTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABMTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'ABMTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABMTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'CPIM'
WHEN PARTY = 'ABMTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'ABMTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BMATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BMATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'CPIM'
WHEN PARTY = 'BMATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'BMATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'BMATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'MBATO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'CPIM'
WHEN PARTY = 'MBATO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'MBATO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'AIADMK'
WHEN PARTY = 'MBATO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'MBATO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'AKDTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'AKDTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AMMK'
WHEN PARTY = 'AKDTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'DMK'
WHEN PARTY = 'AKDTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'AKDTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ANUTO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AIADMK'
WHEN PARTY = 'ANUTO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'OPS' --IND
WHEN PARTY = 'ANUTO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'IUML'
WHEN PARTY = 'ANUTO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'NTK'
WHEN PARTY = 'ANUTO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'TAMIL%'
  AND Campaign_Name LIKE 'TN-PP-%'
  AND Start_Time >= '2024-04-05'
  AND PC_NO NOT IN (3,19,20,37,38,39)
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""

pp_uk = """
WITH CTE AS
(
SELECT				--- UK LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTARA%'
  AND Campaign_Name LIKE 'UK-PP-%'
  AND Start_Time >= '2024-04-05'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""

pp_up = """
WITH CTE AS
(
SELECT * FROM
(
SELECT				-- UP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RLD'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RLD'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SBSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SBSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AD'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AD'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTAR%'
  AND Campaign_Name LIKE 'UP-PP-%'
  AND Start_Time >= '2024-04-05'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO <> 37

  UNION ALL

SELECT				-- UP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'INC'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BIMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'INC'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'IBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'RLD'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'RSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'RLD'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SRMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SBSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'PSMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SBSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SPMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AD'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'SP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'SP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AD'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'BSP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTAR%'
  AND Campaign_Name LIKE 'UP-PP-%'
  AND Start_Time >= '2024-05-16'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO = 37
  ) AS T3 WHERE PC_NO NOT IN (79,80)

  UNION ALL

  SELECT				-- UP LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '3,%' OR RESPONSE LIKE '3' ) THEN 'AD'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '4,%' OR RESPONSE LIKE '4' ) THEN 'SP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BSP'
WHEN PARTY = 'ASMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'OTHERS'
--
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '3,%' OR RESPONSE LIKE '3' ) THEN 'SP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '4,%' OR RESPONSE LIKE '4' ) THEN 'AD'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BSP'
WHEN PARTY = 'SAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'OTHERS'
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'UTTAR%'
  AND Campaign_Name LIKE 'UP-PP-%'
  AND Start_Time >= '2024-05-25'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL AND PC_NO IN (79,80)
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""

pp_wb = """
WITH CTE AS
(
SELECT				-- WB LSE/PP
*
FROM
(
SELECT
STATE_CODE + '-' + CAST(PC_NO AS varchar) AS PC_ID,
*,
PARTY AS SEQ,
CASE
WHEN PARTY = 'BTIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'BTIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN PARTY = 'BTIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'TBIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN PARTY = 'TBIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BTRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN PARTY = 'BTRO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN PARTY = 'TBRO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN PARTY = 'BTMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN PARTY = 'TBMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'ABIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '8' ) THEN 'INC'
WHEN PARTY = 'ABIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BAIO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAIO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BAIO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '8' ) THEN 'INC'
WHEN PARTY = 'BAIO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BAMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BAMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN PARTY = 'BAMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABMO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'ABMO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABMO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPIM'
WHEN PARTY = 'ABMO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BACO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BACO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BACO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN PARTY = 'BACO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABCO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'ABCO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABCO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN PARTY = 'ABCO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN PARTY = 'BARO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'RSP'
WHEN PARTY = 'ABRO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'ABIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'ABIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN PARTY = 'ABIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BAIFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAIFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BAIFO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'BAIFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN PARTY = 'BAIFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABICO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'ABICO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABICO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'ABICO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN PARTY = 'ABICO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BAICO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAICO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BAICO' AND ( RESPONSE LIKE '7,%' OR RESPONSE LIKE '7' ) THEN 'INC'
WHEN PARTY = 'BAICO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'CPI'
WHEN PARTY = 'BAICO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'ABFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'AITC'
WHEN PARTY = 'ABFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'BJP'
WHEN PARTY = 'ABFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN PARTY = 'ABFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
WHEN PARTY = 'BAFO' AND ( RESPONSE LIKE '5,%' OR RESPONSE LIKE '5' ) THEN 'BJP'
WHEN PARTY = 'BAFO' AND ( RESPONSE LIKE '6,%' OR RESPONSE LIKE '6' ) THEN 'AITC'
WHEN PARTY = 'BAFO' AND ( RESPONSE LIKE '8,%' OR RESPONSE LIKE '8' ) THEN 'AIFB'
WHEN PARTY = 'BAFO' AND ( RESPONSE LIKE '9,%' OR RESPONSE LIKE '9' ) THEN 'OTHERS'
--
ELSE NULL END AS RES1,
'' AS RES2
FROM
(
SELECT 
MAX(LEFT(Campaign_Name,2)) AS STATE_CODE
	,CAST('' AS INT) AS [VENDOR_ID]
      ,[DN] AS [MOBILE]
      ,MAX([CALL_STATUS]) AS [CALL_STATUS]
      ,MAX([Start_Time]) AS [STIME]
      ,MAX([Call_Duration_Sec_]) AS [DURATION]
      ,MAX([DTMF_REP]) AS [RESPONSE]
      ,MAX([VENDOR]) AS [VENDOR]
      ,MAX([N_PARTY]) AS [PARTY]		-- CHANGE PARTY COLUMN 
      ,MAX([AC_NO]) AS [AC_NO]
	  ,MAX([PC_NO]) AS [PC_NO]
      ,MAX([PART_NO]) AS [BOOTH]
      ,MAX([EPIC_NO]) AS [VOTERIDNUMBER]
      ,MAX([GENDER]) AS [GENDER]
      ,MAX([AGE]) AS [AGE]
      ,MAX([POLLING_STATION_ADDRESS]) AS [POOLINGBOOTH]
	  ,MAX([state]) AS [state]
	  ,MAX([CASTE]) AS [CASTE]
  FROM [voter].[dbo].[ac_data_response] 
  WHERE 
  DTMF_REP IS NOT NULL AND DTMF_REP <> '' AND DTMF_REP <> ',,' 
  AND state LIKE 'WEST%'
  AND Campaign_Name LIKE 'WB-PP-%'
  AND Start_Time >= '2024-04-05'
  GROUP BY DN
  ) AS T1
  ) AS T2
  WHERE RES1 IS NOT NULL
)
SELECT
MOBILE AS DN,
STIME AS Start_Time,
RESPONSE AS DTMF_REP,
state,
STATE_CODE + '-AC-' + CAST(AC_NO AS varchar) AS AC_ID,
AC_NO,
PC_ID,
PC_NO,
BOOTH AS PART_NO,
GENDER,
AGE,
SEQ AS N_PARTY,
RES1,
RES2,
CASTE
FROM CTE
"""
